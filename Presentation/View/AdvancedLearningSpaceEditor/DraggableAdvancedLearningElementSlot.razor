@using Presentation.PresentationLogic.LearningElement
@using Presentation.PresentationLogic.LearningSpace
@using System.Diagnostics.CodeAnalysis
@using Presentation.PresentationLogic.AdvancedLearningSpaceEditor.AdvancedComponent
@using Presentation.PresentationLogic.AdvancedLearningSpaceEditor.AdvancedLearningSpace
@using Presentation.View.LearningElement

<MudDropZone
    T="ILearningElementViewModel"
    Identifier="@AdvancedComponent.Identifier"
    class="rounded-lg border-2 border-adlerblue bg-adlerdeactivatedtext mud-border-lines-default p-0 m-0 w-[20px] h-[20px] flex justify-center items-center"
    style="position:relative; top:50px; left: 50px;"
    @* top:@AdvancedComponent.PositionY-10; left:@AdvancedComponent.PositionX-10 *@
    @onclick="() => LearningSpaceP.ClickOnSlot(AdvancedComponent.SlotKey)"
    >

    <ItemRenderer>
        @* this is only to drag and drop the element itself, not the slot *@
        <DragDropLearningElement
            LearningElement="@context"
            OnShowLearningElementContent="@LearningSpaceP.ShowElementContent"
            OnEditLearningElement="@LearningSpaceP.ClickedLearningElement"
            OnDeleteLearningElement="@LearningSpaceP.DeleteLearningElement"
            OnClicked="@LearningSpaceP.ClickedLearningElement"/>
    </ItemRenderer>
    <ChildContent>
        @{
            var advancedSpaceVm = LearningSpaceP.LearningSpaceVm as AdvancedLearningSpaceViewModel;
            if (advancedSpaceVm == null || advancedSpaceVm.GetType() != typeof(AdvancedLearningSpaceViewModel))
            {
                throw new Exception("LearningSpaceP.LearningSpaceVm is not of type AdvancedLearningSpaceViewModel");
            }
            if (!advancedSpaceVm.AdvancedLearningSpaceLayout.AdvancedLearningElementSlots.ContainsKey(AdvancedComponent.SlotKey))
            {
                <MudIcon Icon="@Icons.Material.Filled.Add" Style="font-size: 2rem;" Class="text-white"></MudIcon>
            }
        }
    </ChildContent>
</MudDropZone>
@* insert draggable code here haha *@
@code {
    [Inject, AllowNull]
    public ILearningSpacePresenter LearningSpaceP { get; set; }
    
    [Parameter, EditorRequired]
    public IAdvancedLearningElementSlotViewModel AdvancedComponent { get; set; } = null!;

}